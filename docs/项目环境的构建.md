# 项目环境的构建

1. 创建`mariadb`数据库，将数据库名、用户名和密码存入`.env`中，例如：

    ```shell
    # .env
    # 用户名为 user，密码为 password，数据库为 database
    DATABASE_URL=mysql://user:password@localhost:3306/database
    ```

2. 创建`python`环境：

    ```shell
    conda create -n raa-openvault python=3.12     # 创建conda环境
    conda activate raa-openvault                  # 进入conda环境
    conda install poetry -c conda-forge           # 安装项目管理工具poetry
    poetry install                                # 安装依赖
    ```

3. 写入前端应用链接

    因为跨域限制，需要在后端应用中标注前端应用的源，该条目保存在`.env`中：

    ```shell
    # .env
    APP_BASE_URL=http://localhost:8000
    ```

4. 使用`cli`

    `openvault`是本项目的脚手架程序，有两种方法使用：

    - 如果不安装项目到本地环境中，可以通过`poetry`调用
  
        ```shell
        poetry run openvault server run       # 启动服务器
        ```

    - 如果安装项目到本地环境中，可以使用`openvault`命令：

        ```shell
        poetry install      # 将本地项目安装到当前环境中
        openvault server run  # 启动服务器
        ```

    > 安装项目的方法请参考[安装本地项目](./安装本地项目.md)
    >
    > 脚手架命令请参考[脚手架命令](./脚手架命令.md) 或使用`openvault --help`

## `.env` 文件参考

该文件标记了程序运行中的环境变量，可以手动覆盖。

通过`APP_BASE_URL=<URL> <命令>`的方式可以动态修改他们的值，例如：

```shell
APP_BASE_URL=http://localhost:3000 openvault server run      # 跨域检查会允许 127.0.0.1:3000 的请求
```
